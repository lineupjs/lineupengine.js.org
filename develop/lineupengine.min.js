!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.lineupengine=e():t.lineupengine=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=10)}([function(t,e,i){"use strict";e.e=function(t,e,i=0){return{exceptions:[],exceptionsLookup:{keys:()=>[].values(),get:()=>e,has:()=>!1,size:0},totalHeight:t*(e+=i),numberOfRows:t,defaultRowHeight:e,padding:()=>i}},e.b=o,e.c=function(t,e,i=2,s=10*e,n=.2,r=Date.now()){let l=r;const a=()=>{const t=1e4*Math.sin(l++);return t-Math.floor(t)},h=()=>{const t=a();return t<n?i+Math.round(a()*(s-i)):e};return o({forEach:e=>{for(let i=0;i<t;++i)e(h(),i)}},e)},e.d=function(t,e,i,s,o){if(0===o)return{first:0,last:-1,firstRowPos:0,endPos:0};if(1===o)return{first:0,last:0,firstRowPos:0,endPos:0===s.length?i:s[0].y2};const n=t,r=n+e;function l(t,e){return Math.min(o-1,e+Math.max(0,Math.floor(t/i)))}function a(t,e,s=!1){const a=n-t,h=r-t,c=l(a,e),d=l(h,e),u=t+(c-e)*i,f=t+(d+1-e)*i;return console.assert(!s||!(u>n||f<r&&d<o-1),"error",s,u,f,n,r,e,t),{first:c,last:d,firstRowPos:u,endPos:f}}const h=a(0,0,!0);if(0===s.length)return h;if(h.last<s[0].index)return h;if(h.last===s[0].index&&s[0].height>i)return Object.assign(h,{endPos:s[0].y2});const c=s[s.length-1];if(n>=c.y){const t=a(c.y2,c.index+1);return n<c.y2?Object.assign(t,{first:c.index,firstRowPos:c.y}):t}const d=[];let u=s[0];for(const t of s){const{y:e,y2:i}=t;if(e>=r)break;i<=n?u=t:d.push(t)}if(0===d.length)return a(u.y2,u.index+1);{const t=d[0],e=d[d.length-1],s=Math.max(0,t.index-Math.max(0,Math.ceil((t.y-n)/i)));let a=e.index;r>=e.y2&&(a=l(r-e.y2,e.index+1));const h=t.y-(t.index-s)*i,c=e.y2+(a-e.index)*i;return console.assert(h<=n&&(c>=r||a===o-1),"error",h,c,n,r,t,e),{first:s,last:a,firstRowPos:h,endPos:c}}},e.a=function(t,e){const i=t.length,s=e.length;if(0===i)return{added:e,removed:[],common:0};if(0===s)return{added:[],removed:t,common:0};if(i===s)return{added:[],removed:[],common:i};const o=t.slice(Math.min(s,i));return{added:e.slice(Math.min(s,i)),removed:o,common:i-o.length}},e.f=function(t,e,i){const s=0===t.length?0:t[t.length-1]+1,o=[],n=[];for(let e=t.length-1;e>=0;--e){const s=t[e];if(!(s>=i))break;n.push(t.pop())}for(let n=s;n<i;++n)e[n].frozen&&(o.push(n),t.push(n));return{target:t,added:o,removed:n}};class s{constructor(t,e,i){this.index=t,this.y=e,this.height=i}get y2(){return this.y+this.height}}function o(t,e=NaN,i=0){const o=new Map,n=[],r="function"==typeof i?i:()=>i;isNaN(e)&&(e=function(t){const e=new Map;if(t.forEach(t=>{e.set(t,(e.get(t)||0)+1)}),0===e.size)return 20;const i=Array.from(e).sort((t,e)=>t[1]!==e[1]?e[1]-t[1]:t[0]-e[0]),s=i[0][0];return 0===s?i.length>1?i[1][0]:20:s}(t)),e+=r(-1);let l=-1,a=0,h=0,c=0;return t.forEach((t,i)=>{if(t+=r(i),h+=t,c++,t===e)return;o.set(i,t);const d=(i-l-1)*e;l=i;const u=a+d;a=u+t,n.push(new s(i,u,t))}),{exceptionsLookup:o,exceptions:n,totalHeight:h,defaultRowHeight:e,numberOfRows:c,padding:r}}},function(t,e,i){"use strict";var s=i(6);i.d(e,"a",function(){return s.a});var o=i(13);i.d(e,"b",function(){return o.a})},function(t,e,i){"use strict";var s=i(4),o=i(12),n=i(5),r=i(0),l=i(1);class a{constructor(t,e={}){this.body=t,this.pool=[],this.loadingPool=[],this.loading=new Map,this.visible={first:0,forcedFirst:0,last:-1,forcedLast:-1},this.visibleFirstRowPos=0,this.abortAnimation=(()=>void 0),this.options={async:Boolean(window.chrome)?"animation":"immediate",minScrollDelta:3,mixins:[],scrollingHint:!1},this.adapter=this.createAdapter(),Object.assign(this.options,e),this.mixins=this.options.mixins.map(t=>new t(this.adapter)),this.fragment=t.ownerDocument.createDocumentFragment()}addMixin(t,e){this.mixins.push(new t(this.adapter,e))}createAdapter(){const t={visible:this.visible,addAtBeginning:this.addAtBeginning.bind(this),addAtBottom:this.addAtBottom.bind(this),removeFromBeginning:this.removeFromBeginning.bind(this),removeFromBottom:this.removeFromBottom.bind(this),updateOffset:this.updateOffset.bind(this),scroller:this.bodyScroller};return Object.defineProperties(t,{visibleFirstRowPos:{get:()=>this.visibleFirstRowPos,enumerable:!0},context:{get:()=>this.context,enumerable:!0}}),t}get bodyScroller(){return this.body.parentElement}init(){const t=this.bodyScroller;let e=t.scrollTop;const i=()=>{const i=t.scrollTop;if(Math.abs(e-i)<this.options.minScrollDelta)return;const s=i>e;e=i,this.onScrolledVertically(i,t.clientHeight,s),this.options.scrollingHint&&t.classList.remove("le-scrolling")};this.scrollListener=this.createDelayedHandler(i,()=>{this.options.scrollingHint&&t.classList.add("le-scrolling")}),t.addEventListener("scroll",this.scrollListener),this.recreate()}createDelayedHandler(t,e){const i="function"==typeof window.setImmediate;let s;s="immediate"===this.options.async&&i?setImmediate:"animation"===this.options.async||"immediate"===this.options.async?requestAnimationFrame:"number"==typeof this.options.async?t=>self.setTimeout(t,this.options.async):t=>(t(),-1);let o=-1;const n=()=>{o=-1,t()};return()=>{e&&e(),o>-1||(o=s(n))}}destroy(){this.bodyScroller.removeEventListener("scroll",this.scrollListener),this.body.remove()}static cleanUp(t){t.style.height&&(t.style.height=null)}select(t){let e,i;return this.pool.length>0?(e=this.pool.pop(),i=this.updateRow(e,t)):this.loadingPool.length>0?((e=this.loadingPool.pop()).classList.remove("loading"),i=this.createRow(e,t)):(e=this.body.ownerDocument.createElement("div"),i=this.createRow(e,t)),e.dataset.index=String(t),{item:e,result:i}}selectProxy(){let t;return this.loadingPool.length>0?t=this.loadingPool.pop():(t=this.body.ownerDocument.createElement("div")).classList.add("loading"),t}recycle(t){if(a.cleanUp(t),this.loading.has(t)){this.loading.get(t).abort()}else this.pool.push(t)}proxy(t,e){if(!Object(s.b)(e))return t;const i=e,o=t,n=this.selectProxy();return n.dataset.index=o.dataset.index,n.style.height=o.style.height,this.loading.set(n,i),i.then(t=>{t===s.a?(a.cleanUp(o),this.pool.push(o)):this.body.replaceChild(o,n),this.loading.delete(n),a.cleanUp(n),this.loadingPool.push(n)}),n}create(t){const{item:e,result:i}=this.select(t),{exceptionsLookup:s,padding:o}=this.context;return s.has(t)&&(e.style.height=`${s.get(t)-o(t)}px`),this.proxy(e,i)}removeAll(){const t=Array.from(this.body.children);this.body.innerHTML="",t.forEach(t=>{this.recycle(t)})}update(){const t=this.visible.first,e=this.fragment,i=Array.from(this.body.children);this.body.innerHTML="",i.forEach((i,s)=>{if(this.loading.has(i))return;const o=this.updateRow(i,s+t);e.appendChild(this.proxy(i,o))}),this.body.appendChild(e)}forEachRow(t,e=!1){const i=Array.from(this.body.children),s=this.fragment;e||(this.body.innerHTML=""),i.forEach((i,o)=>{i.classList.contains("loading")||"update_remove"===i.dataset.animation||"hide"===i.dataset.animation||t(i,o+this.visible.first),e||s.appendChild(i)}),e||this.body.appendChild(s)}removeFromBeginning(t,e){return this.remove(t,e,!0)}removeFromBottom(t,e){return this.remove(t,e,!1)}remove(t,e,i){for(let s=t;s<=e;++s){const t=i?this.body.firstChild:this.body.lastChild;t.remove(),this.recycle(t)}}addAtBeginning(t,e){if(t===e)return void this.body.insertBefore(this.create(t),this.body.firstChild);const i=this.fragment;for(let s=t;s<=e;++s)i.appendChild(this.create(s));this.body.insertBefore(i,this.body.firstChild)}addAtBottom(t,e){if(t===e)return void this.body.appendChild(this.create(t));const i=this.fragment;for(let s=t;s<=e;++s)i.appendChild(this.create(s));this.body.appendChild(i)}updateOffset(t){const{totalHeight:e}=this.context;this.visibleFirstRowPos=t,this.body.classList.toggle("odd",this.visible.first%2==1),this.body.style.transform=`translate(0, ${t.toFixed(0)}px)`,this.body.style.height=`${Math.max(1,e-t).toFixed(0)}px`}recreate(t){return this.abortAnimation(),t?this.recreateAnimated(t):this.recreatePure()}recreatePure(){const t=this.context,e=this.bodyScroller;this.updateOffset(0),this.removeAll(),this.clearPool();const{first:i,last:s,firstRowPos:o}=Object(r.d)(e.scrollTop,e.clientHeight,t.defaultRowHeight,t.exceptions,t.numberOfRows);this.visible.first=this.visible.forcedFirst=i,this.visible.last=this.visible.forcedLast=s,i<0?this.updateOffset(0):(this.addAtBottom(i,s),this.updateOffset(o))}recreateAnimated(t){const e=new Map,i=new n.a(t.previous,t.previousKey),s=new n.a(this.context,t.currentKey),l=Object(r.d)(this.bodyScroller.scrollTop,this.bodyScroller.clientHeight,s.context.defaultRowHeight,s.context.exceptions,s.context.numberOfRows);{const t=Array.from(this.body.children),s=Object.assign({},this.visible);i.positions(s.first,Math.min(s.last,s.first+t.length),this.visibleFirstRowPos,(i,s,o)=>{const n=t[i];n&&e.set(s,{n,pos:o,i})}),this.body.innerHTML=""}this.visible.first=this.visible.forcedFirst=l.first,this.visible.last=this.visible.forcedLast=l.last;const a=this.fragment,h=[];let c=l.firstRowPos;s.positions(l.first,l.last,l.firstRowPos,(t,n,r)=>{let l,d,u=o.a.UPDATE;if(e.has(n)){const s=e.get(n);e.delete(n),s.n.dataset.index=String(t),l=this.proxy(s.n,this.updateRow(s.n,t)),d={index:s.i,y:s.pos,height:i.exceptionHeightOf(s.i,!0)}}else{const e=i.posByKey(n);l=this.create(t),u=e.index<0?o.a.SHOW:o.a.UPDATE_CREATE,d={index:e.index,y:e.pos>=0?e.pos:r,height:e.index<0?s.exceptionHeightOf(t,!0):i.exceptionHeightOf(e.index,!0)}}h.push({node:l,key:n,mode:u,previous:d,nodeY:c,nodeYCurrentHeight:r,current:{index:t,y:r,height:s.exceptionHeightOf(t)}}),l.style.transform=`translate(0, ${c-r}px)`,c+=d.height+(d.index<0?s.padding(t):i.padding(d.index)),a.appendChild(l)});let d=l.endPos;e.forEach((t,e)=>{const n=s.posByKey(e),r=n.pos>=0?n.pos:t.pos,l=t.n;l.style.transform=`translate(0, ${t.pos-c}px)`,a.appendChild(l);const u=i.exceptionHeightOf(t.i,!0);h.push({node:t.n,key:e,mode:n.index<0?o.a.HIDE:o.a.UPDATE_REMOVE,previous:{index:t.i,y:t.pos,height:u},nodeY:c,nodeYCurrentHeight:d,current:{index:n.index,y:r,height:n.index<0?null:s.exceptionHeightOf(n.index)}}),d+=n.index<0?s.context.defaultRowHeight:s.exceptionHeightOf(n.index,!0)+s.padding(n.index),c+=u+i.padding(t.i)}),this.updateOffset(l.firstRowPos),this.animate(h,t.phases||o.b,i,s,a)}animate(t,e,i,s,n){if(t.length<=0)return void this.body.appendChild(n);let r=-1,l=0;const a=(e,o=t)=>{o.forEach(t=>e.apply(t,i,s))},h=()=>{if(console.assert(t[0].node.offsetTop>=0,"dummy log for forcing dom update"),a(e[l++]),l<e.length){const t=e[l];return void(r=setTimeout(h,t.delay))}const i=this.body.classList;Array.from(i).forEach(t=>{t.startsWith("le-")&&t.endsWith("-animation")&&i.remove(t)}),t.forEach(({node:t,mode:e})=>{e!==o.a.UPDATE_REMOVE&&e!==o.a.HIDE||(t.remove(),t.style.transform=null,this.recycle(t))}),this.abortAnimation=(()=>void 0),r=-1};for(;0===e[l].delay;)a(e[l++]);const c=this.body;this.body.appendChild(n);const d=[];t=t.filter(t=>!Object(o.c)(t,i.context.defaultRowHeight,s.context.defaultRowHeight)||(d.push(t),!1)),d.length>0&&e.slice(l).forEach(t=>a(t,d)),0!==t.length&&(c.classList.add("le-row-animation"),new Set(t.map(t=>t.mode)).forEach(t=>{c.classList.add(`le-${o.a[t].toLowerCase().split("_")[0]}-animation`)}),this.abortAnimation=(()=>{r<=0||(clearTimeout(r),r=-1,l=e.length-1,h())}),r=setTimeout(h,e[l].delay))}clearPool(){this.pool.splice(0,this.pool.length)}revalidate(){const t=this.bodyScroller;this.onScrolledVertically(t.scrollTop,t.clientHeight,!0),this.updateOffset(this.visibleFirstRowPos)}onScrolledVertically(t,e,i){const s=this.onScrolledImpl(t,e);return this.mixins.forEach(t=>t.onScrolled(i,s)),s}onScrolledImpl(t,e){const i=this.context,{first:s,last:o,firstRowPos:n}=Object(r.d)(t,e,i.defaultRowHeight,i.exceptions,i.numberOfRows),a=this.visible;if(a.forcedFirst=s,a.forcedLast=o,s-a.first>=0&&o-a.last<=0)return l.a.NONE;let h=l.a.PARTIAL;return s>a.last||o<a.first?(this.removeAll(),this.addAtBottom(s,o),h=l.a.ALL):s<a.first?(this.removeFromBottom(o+1,a.last),this.addAtBeginning(s,a.first-1)):(this.removeFromBeginning(a.first,s-1),this.addAtBottom(a.last+1,o)),a.first=s,a.last=o,this.updateOffset(n),h}}e.a=a,e.b=a},function(t,e,i){"use strict";var s=i(7);i.d(e,"a",function(){return s.b}),i.d(e,"d",function(){return s.c}),i.d(e,"c",function(){return s.a}),i.d(e,"e",function(){return s.d});var o=i(8);i.d(e,"b",function(){return o.a})},function(t,e,i){"use strict";e.b=function(t){return void 0!==t&&null!==t&&t&&"function"==typeof t.then&&"function"==typeof t.abort};const s=Symbol("aborted");e.a=s},function(t,e,i){"use strict";e.a=class{constructor(t,e){this.context=t,this.key=e,this.cache=[],this.lastFilled=0,this.key2index=new Map,this.context.exceptions.forEach(t=>{this.cache[t.index]=t.y,this.key2index.set(e(t.index),t.index)})}findValidStart(t){for(let e=t-1;e>=0;--e)if(void 0!==this.cache[e])return e;return-1}posByKey(t){if(this.key2index.has(t)){const e=this.key2index.get(t);return{index:e,pos:this.pos(e)}}return this.fillCacheTillKey(t)}pos(t){if(0===this.context.exceptions.length)return t*this.context.defaultRowHeight;const e=this.cache[t];if(void 0!==e)return e;const i=this.findValidStart(t);return i<0?this.fillCache(0,t,0):this.fillCache(i+1,t,this.cache[i]+this.heightOf(i)),this.cache[t]}fillCache(t,e,i,s){if(e<=this.lastFilled){if(!s)return;for(let i=t;i<=e;++i)s(i,this.key(i),this.cache[i]);return}let o=i;for(let i=t;i<=e;++i){this.cache[i]=o;const t=this.key(i);this.key2index.set(t,i),s&&s(i,t,o),o+=this.heightOf(i)}}heightOf(t){const e=this.context.exceptionsLookup;return e.has(t)?e.get(t):this.context.defaultRowHeight}exceptionHeightOf(t,e=!1){const i=this.context.padding(t),s=this.context.exceptionsLookup;return s.has(t)?s.get(t)-i:e?this.context.defaultRowHeight-i:null}padding(t){return this.context.padding(t)}fillCacheTillKey(t){let e=0;for(let i=this.lastFilled;i<this.context.numberOfRows;++i,++this.lastFilled){const s=this.cache[i];if(void 0!==s){e=s+this.heightOf(i);continue}const o=this.key(i);if(this.cache[i]=e,this.key2index.set(o,i),o===t)return{index:i,pos:e};e+=this.heightOf(i)}return{index:-1,pos:-1}}positions(t,e,i,s){this.fillCache(t,e,i,s)}}},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var s;(o=s||(s={}))[o.NONE=0]="NONE",o[o.ALL=1]="ALL",o[o.PARTIAL=2]="PARTIAL";var o},function(t,e,i){"use strict";e.d=function(t){return t.innerHTML=o,t},e.c=function(t,e){t.style.gridColumnStart=e.id,t.dataset.id=e.id};var s=i(8);const o="\n  <header>\n    <article></article>\n  </header>\n  <main>\n    <article></article>\n  </main>";e.a=o;class n extends s.a{constructor(t,e){super(t),this.id=e;const i=t.querySelector("header"),s=t.querySelector("main");s.addEventListener("scroll",()=>{i.scrollLeft=s.scrollLeft})}static columnWidths(t,e="px"){function i(t,e){return`repeat(${t}, ${e})`}const s=i;let o=0,n=0,r="";return t.forEach(({width:t})=>{o!==t?(n>0&&(r+=1===n?`${o}${e} `:`${s(n,`${o}${e}`)} `),n=1,o=t):n++}),n>0&&(r+=1===n?`${o}${e}`:`${s(n,`${o}${e}`)}`),r}static gridColumn(t,e="px"){const i=n.columnWidths(t,e);return`grid-template-columns: ${i};\n      grid-template-areas: "${t.map(t=>t.id).join(" ")}";`}update(t,e,i,s,o="px"){const r=void 0!==s?this.tableIds(s,!0):{header:`${this.id} > header > article`,body:`${this.id} > main > article`};if(this.updateRule(`__heightsRule${r.body}`,`${r.body} > div {\n      height: ${t}px;\n    }`),0===e.length)return void this.deleteRule(`__widthRule${r.body}`);const l=n.gridColumn(e,o);this.updateRule(`__widthRule${r.body}`,`${r.body} > div, ${r.header} { ${l} }`),this.updateFrozen(e,r,i,o)}remove(t){const e=this.tableIds(t,!0);this.deleteRule(`__heightsRule${e.body}`),this.deleteRule(`__widthRule${e.body}`);const i=`__frozen${e.body}_`,s=this.ruleNames.reduce((t,e)=>t+(e.startsWith(i)?1:0),0);for(let t=0;t<s;++t)this.deleteRule(`${i}${t}`)}tableIds(t,e=!1){const i=this.id.startsWith("#")?this.id.slice(1):this.id;return{header:`${e?"#":""}${i}_H${t}`,body:`${e?"#":""}${i}_B${t}`}}updateFrozen(t,e,i,s){const o=`__frozen${e.body}_`,n=this.ruleNames.reduce((t,e)=>t+(e.startsWith(o)?1:0),0),r=t.filter(t=>t.frozen);if(r.length<=0){for(let t=0;t<n;++t)this.deleteRule(`${o}${t}`);return}let l=r[0].width;r.slice(1).forEach((t,i)=>{const n=`${e.body} > div > .frozen[data-id="${t.id}"], ${e.header} .frozen[data-id="${t.id}"] {\n        left: ${l}${s};\n      }`;l+=t.width,this.updateRule(`${o}${i}`,n)});for(let t=r.length-1;t<n;++t)this.deleteRule(`${o}${t}`)}}e.b=n},function(t,e,i){"use strict";e.a=class{constructor(t){this.rules=new Map,this.node=t.ownerDocument.createElement("style"),t.appendChild(this.node)}destroy(){this.node.remove()}recreate(){this.node.innerHTML=Array.from(this.rules.values()).join("\n")}addRule(t,e){return this.rules.set(t,e),this.recreate(),t}updateRule(t,e){return this.rules.set(t,e),this.recreate(),t}deleteRule(t){const e=this.rules.get(t);e&&(this.rules.delete(t),this.recreate())}get ruleNames(){return Array.from(this.rules.keys())}}},function(t,e,i){"use strict";var s=i(0),o=i(1),n=i(7);const r=!1;e.a=class{constructor(t,e,i,...s){this.header=t,this.style=e,this.tableId=i,this.cellPool=[],this.visibleColumns={frozen:[],first:0,forcedFirst:0,last:-1,forcedLast:-1},this.visibleFirstColumnPos=0,this.columnAdapter=this.createColumnAdapter(),this.columnMixins=s.map(t=>new t(this.columnAdapter)),this.columnFragment=t.ownerDocument.createDocumentFragment()}get headerScroller(){return this.header.parentElement}addColumnMixin(t,e){this.columnMixins.push(new t(this.columnAdapter,e))}createColumnAdapter(){const t={visible:this.visibleColumns,addAtBeginning:this.addColumnAtStart.bind(this),addAtBottom:this.addColumnAtEnd.bind(this),removeFromBeginning:this.removeColumnFromStart.bind(this),removeFromBottom:this.removeColumnFromEnd.bind(this),updateOffset:this.updateColumnOffset.bind(this),scroller:this.headerScroller,syncFrozen:this.syncFrozen.bind(this)};return Object.defineProperties(t,{visibleFirstRowPos:{get:()=>this.visibleFirstColumnPos,enumerable:!0},context:{get:()=>this.context.column,enumerable:!0}}),t}init(){const t=this.context;this.style.update(t.defaultRowHeight-t.padding(-1),t.columns,t.column.padding,this.tableId),t.columns.forEach(()=>{this.cellPool.push([])})}onScrolledHorizontally(t,e,i){const s=this.onScrolledHorizontallyImpl(t,e);return this.columnMixins.forEach(t=>t.onScrolled(i,s)),s}removeColumnFromStart(t,e,i=this.visibleColumns.frozen.length){this.forEachRow(s=>{this.removeCellFromStart(s,t,e,i)}),r&&this.verifyRows()}removeCellFromStart(t,e,i,s){for(let o=e;o<=i;++o){const e=0===s?t.firstElementChild:t.children[s];e.remove(),this.recycleCell(e,o)}r&&l(t,-1,this.context.columns)}removeColumnFromEnd(t,e){this.forEachRow(i=>{this.removeCellFromEnd(i,t,e)}),r&&this.verifyRows()}removeCellFromEnd(t,e,i){for(let s=i;s>=e;--s){const e=t.lastElementChild;e.remove(),this.recycleCell(e,s)}r&&l(t,-1,this.context.columns)}removeFrozenCells(t,e,i){for(const s of e){const e=t.children[i];e.remove(),this.recycleCell(e,s)}r&&l(t,-1,this.context.columns)}removeFrozenColumns(t,e){this.forEachRow(i=>{this.removeFrozenCells(i,t,e)}),r&&this.verifyRows()}removeAllColumns(t){this.forEachRow(e=>{this.removeAllCells(e,t)}),r&&this.verifyRows()}removeAllCells(t,e,i=this.visibleColumns.first){const s=Array.from(t.children),o=this.visibleColumns.frozen;if(t.innerHTML="",e||0===o.length)for(const t of o)this.recycleCell(s.shift(),t);else for(const e of o)t.appendChild(s.shift());s.forEach((t,e)=>{this.recycleCell(t,e+i)}),r&&l(t,-1,this.context.columns)}selectCell(t,e,i){const s=this.cellPool[e],o=i[e];if(s.length>0){const e=s.pop(),i=this.updateCell(e,t,o);return i&&i!==e&&Object(n.c)(i,o),i||e}const r=this.createCell(this.header.ownerDocument,t,o);return Object(n.c)(r,o),r}recycleCell(t,e){this.cellPool[e].push(t)}addColumnAtStart(t,e,i=this.visibleColumns.frozen.length){const{columns:s}=this.context;this.forEachRow((o,n)=>{this.addCellAtStart(o,n,t,e,i,s)}),r&&this.verifyRows()}addCellAtStart(t,e,i,s,o,n){r&&l(t,e,this.context.columns);for(let r=s;r>=i;--r){const i=this.selectCell(e,r,n);t.insertBefore(i,o>0?t.children[o]:t.firstChild)}r&&l(t,e,this.context.columns)}insertFrozenCells(t,e,i,s,o){const n=t.children[s];for(const s of i){const i=this.selectCell(e,s,o);n?t.insertBefore(i,n):t.appendChild(i)}}insertFrozenColumns(t,e){const{columns:i}=this.context;this.forEachRow((s,o)=>{this.insertFrozenCells(s,o,t,e,i)})}addColumnAtEnd(t,e){const{columns:i}=this.context;this.forEachRow((s,o)=>{this.addCellAtEnd(s,o,t,e,i)}),r&&this.verifyRows()}verifyRows(){const{columns:t}=this.context;this.forEachRow((e,i)=>l(e,i,t))}addCellAtEnd(t,e,i,s,o){for(let n=i;n<=s;++n){const i=this.selectCell(e,n,o);t.appendChild(i)}r&&l(t,e,this.context.columns)}updateHeaders(){const{columns:t}=this.context;Array.from(this.header.children).forEach((e,i)=>{this.updateHeader(e,t[i])})}recreate(t,e){const i=this.context;void 0===i.hasFrozenColumns&&(i.hasFrozenColumns=i.columns.some(t=>t.frozen)),this.style.update(i.defaultRowHeight-i.padding(-1),i.columns,i.column.padding,this.tableId),this.clearPool();for(let t=this.cellPool.length;t<i.columns.length;++t)this.cellPool.push([]);{const t=this.columnFragment,e=t.ownerDocument;this.header.innerHTML="",i.columns.forEach(i=>{const s=this.createHeader(e,i);Object(n.c)(s,i),t.appendChild(s)}),this.header.appendChild(t)}const{first:o,last:r,firstRowPos:l}=Object(s.d)(t,e,i.column.defaultRowHeight,i.column.exceptions,i.column.numberOfRows);if(this.visibleColumns.first=this.visibleColumns.forcedFirst=o,this.visibleColumns.last=this.visibleColumns.forcedLast=r,i.hasFrozenColumns){const{target:t}=Object(s.f)([],i.columns,o);this.visibleColumns.frozen=t}this.updateColumnOffset(l)}clearPool(){this.cellPool.forEach(t=>t.splice(0,t.length))}updateColumnOffset(t){this.visibleFirstColumnPos=t}createRow(t,e){const{columns:i,hasFrozenColumns:s}=this.context,o=this.visibleColumns;if(s)for(const s of o.frozen){const o=this.selectCell(e,s,i);t.appendChild(o)}for(let s=o.first;s<=o.last;++s){const o=this.selectCell(e,s,i);t.appendChild(o)}}updateRow(t,e){const{columns:i,hasFrozenColumns:o}=this.context,r=this.visibleColumns,l=Array.from(t.children);switch(l.length){case 0:o&&this.insertFrozenCells(t,e,r.frozen,0,i),this.addCellAtEnd(t,e,r.first,r.last,i);break;case 1:const a=l[0],h=a.dataset.id,c=i.findIndex(t=>t.id===h);t.removeChild(a),this.recycleCell(a,c),o&&this.insertFrozenCells(t,e,r.frozen,0,i),this.addCellAtEnd(t,e,r.first,r.last,i);break;default:if(o){const o=[];for(const t of l){const e=t.dataset.id,s=i.findIndex(t=>t.id===e);if(!i[s].frozen)break;o.push(s)}const{common:a,removed:h,added:c}=Object(s.a)(o,r.frozen);l.slice(0,a).forEach((s,r)=>{const l=i[o[r]],a=this.updateCell(s,e,l);a&&a!==s&&(Object(n.c)(a,l),t.replaceChild(a,s))}),this.removeFrozenCells(t,h,a),this.insertFrozenCells(t,e,c,a,i),l.splice(0,o.length)}if(0===l.length)break;const d=l[0].dataset.id,u=l[l.length-1].dataset.id,f=i.findIndex(t=>t.id===d),p=i.findIndex(t=>t.id===u),m=r.frozen.length;f===r.first&&p===r.last?l.forEach((s,o)=>{const l=i[o+r.first],a=this.updateCell(s,e,l);a&&a!==s&&(Object(n.c)(a,l),t.replaceChild(a,s))}):r.last>f||r.first<p?(this.removeAllCells(t,!1,f),this.addCellAtStart(t,e,r.first,r.last,m,i)):r.first<f?(this.removeCellFromEnd(t,r.last+1,f),this.addCellAtStart(t,e,r.first,f-1,m,i)):(this.removeCellFromStart(t,f,r.first-1,m),this.addCellAtEnd(t,e,p+1,r.last,i))}}syncFrozen(t){const{columns:e,hasFrozenColumns:i}=this.context,o=this.visibleColumns;if(!i)return 0;if(0===t)return o.frozen.length>0&&(this.removeFrozenColumns(o.frozen,0),o.frozen=[]),0;const n=o.frozen.length,{target:r,added:l,removed:a}=Object(s.f)(o.frozen,e,t);return a.length>0&&this.removeFrozenColumns(a,n-a.length),l.length>0&&this.insertFrozenColumns(l,n-a.length),o.frozen=r,r.length}onScrolledHorizontallyImpl(t,e){const{column:i}=this.context,{first:n,last:r,firstRowPos:l}=Object(s.d)(t,e,i.defaultRowHeight,i.exceptions,i.numberOfRows),a=this.visibleColumns;if(a.forcedFirst=n,a.forcedLast=r,n-a.first>=0&&r-a.last<=0)return o.a.NONE;let h=o.a.PARTIAL;const c=this.syncFrozen(n);return n>a.last||r<a.first?(this.removeAllColumns(!1),this.addColumnAtEnd(n,r),h=o.a.ALL):n<a.first?(this.removeColumnFromEnd(r+1,a.last),this.addColumnAtStart(n,a.first-1,c)):(this.removeColumnFromStart(a.first,n-1,c),this.addColumnAtEnd(a.last+1,r)),a.first=n,a.last=r,this.updateColumnOffset(l),h}};function l(t,e,i){const s=Array.from(t.children);if(s.length<=1)return;const o=s.map(t=>i.find(e=>e.id===t.dataset.id));console.assert(o.every(t=>Boolean(t)),"all columns must exist",e),console.assert(o.every((t,e)=>0===e||t.index>=o[e-1].index),"all columns in ascending order",e),console.assert(new Set(o).size===o.length,"unique columns",o)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(11);i.d(e,"ACellRenderer",function(){return s.a});var o=i(2);i.d(e,"ARowRenderer",function(){return o.a});var n=i(0);i.d(e,"uniformContext",function(){return n.e}),i.d(e,"nonUniformContext",function(){return n.b}),i.d(e,"randomContext",function(){return n.c}),i.d(e,"range",function(){return n.d}),i.d(e,"frozenDelta",function(){return n.a}),i.d(e,"updateFrozen",function(){return n.f});var r=i(4);i.d(e,"ABORTED",function(){return r.a}),i.d(e,"isAbortAble",function(){return r.b});var l=i(3);i.d(e,"GridStyleManager",function(){return l.a}),i.d(e,"setColumn",function(){return l.d}),i.d(e,"TEMPLATE",function(){return l.c}),i.d(e,"setTemplate",function(){return l.e}),i.d(e,"StyleManager",function(){return l.b});var a=i(1);i.d(e,"EScrollResult",function(){return a.a}),i.d(e,"PrefetchMixin",function(){return a.b});var h=i(14);i.d(e,"ACellTableSection",function(){return h.a});e.version="1.0.0-20180108-082103"},function(t,e,i){"use strict";var s=i(2),o=i(3),n=i(9);class r extends s.a{constructor(t,e,i={}){super(Object(o.e)(t).querySelector("main > article"),i),this.root=t,t.classList.add("lineup-engine"),this.style=new o.a(this.root,e);const s=this;class r extends n.a{get context(){return s.context}createHeader(t,e){return s.createHeader(t,e)}updateHeader(t,e){return s.updateHeader(t,e)}createCell(t,e,i){return s.createCell(t,e,i)}updateCell(t,e,i){return s.updateCell(t,e,i)}forEachRow(t){return s.forEachRow(t)}}this.cell=new r(this.header,this.style,void 0,...i.mixins||[])}get header(){return this.root.querySelector("header > article")}get headerScroller(){return this.root.querySelector("header")}addColumnMixin(t,e){this.cell.addColumnMixin(t,e)}init(){this.cell.init();const t=this.body.parentElement;let e=t.scrollLeft;const i=()=>{const i=t.scrollLeft;if(Math.abs(e-i)<this.options.minScrollDelta)return;const s=i>e;e=i,this.onScrolledHorizontally(i,t.clientWidth,s)};t.addEventListener("scroll",this.createDelayedHandler(i)),super.init()}destroy(){super.destroy(),this.root.remove()}onScrolledHorizontally(t,e,i){return this.cell.onScrolledHorizontally(t,e,i)}updateHeaders(){this.cell.updateHeaders()}updateColumnWidths(){const t=this.context;this.style.update(t.defaultRowHeight-t.padding(-1),t.columns,t.column.padding)}recreate(t){const e=this.bodyScroller,i=e.scrollLeft;this.cell.recreate(i,e.clientWidth),super.recreate(t),e.scrollLeft=i}clearPool(){super.clearPool(),this.cell.clearPool()}createRow(t,e){this.cell.createRow(t,e)}updateRow(t,e){this.cell.updateRow(t,e)}}e.a=r},function(t,e,i){"use strict";i.d(e,"a",function(){return s}),e.c=function({previous:t,mode:e,nodeY:i,current:o},r,l){const a=null==t.height?r:t.height,h=null==o.height?l:o.height;return e===s.UPDATE&&Math.abs(t.y-i)<=n&&Math.abs(a-h)<=n};var s;i(5);(o=s||(s={}))[o.UPDATE=0]="UPDATE",o[o.UPDATE_CREATE=1]="UPDATE_CREATE",o[o.UPDATE_REMOVE=2]="UPDATE_REMOVE",o[o.SHOW=3]="SHOW",o[o.HIDE=4]="HIDE";var o;const n=1;const r=[{delay:0,apply({mode:t,previous:e,nodeY:i,current:o,node:n}){n.dataset.animation=s[t].toLowerCase(),n.style.transform=`translate(0, ${e.y-i}px)`,t===s.SHOW?n.style.height=null!==o.height?`${o.height}px`:null:n.style.height=`${e.height}px`,n.style.opacity=t===s.SHOW?"0":t===s.HIDE?"1":null}},{delay:10,apply({mode:t,current:e,nodeY:i,node:o}){o.style.transform=t===s.HIDE||t===s.UPDATE_REMOVE?`translate(0, ${e.y-i}px)`:null,t!==s.HIDE&&(o.style.height=null!==e.height?`${e.height}px`:null),o.style.opacity=t===s.SHOW?"1":t===s.HIDE?"0":null}},{delay:1100,apply({node:t}){delete t.dataset.animation,t.style.opacity=null,t.style.transform=null}}];e.b=r},function(t,e,i){"use strict";var s=i(0),o=i(6);e.a=class{constructor(t,e){return this.adapter=t,this.prefetchTimeout=-1,this.options={prefetchRows:20,cleanUpRows:3,delay:50},Object.assign(this.options,e),this}prefetchDown(){this.prefetchTimeout=-1;const t=this.adapter.context,e=Math.min(this.adapter.visible.last+this.options.prefetchRows,t.numberOfRows-1);this.adapter.visible.last===e&&this.adapter.visible.last>=this.adapter.visible.forcedLast+this.options.prefetchRows||(this.adapter.addAtBottom(this.adapter.visible.last+1,e),this.adapter.visible.last=e)}prefetchUp(){if(this.prefetchTimeout=-1,this.adapter.visible.first<=this.adapter.visible.forcedFirst-this.options.prefetchRows)return;const t=this.adapter.context,e=this.adapter.scroller,i=Math.max(e.scrollTop-this.options.prefetchRows*t.defaultRowHeight,0),o=e.clientHeight,{first:n,firstRowPos:r}=Object(s.d)(i,o,t.defaultRowHeight,t.exceptions,t.numberOfRows);if(n===this.adapter.visible.first)return;const l=this.adapter.syncFrozen?this.adapter.syncFrozen(n):0;this.adapter.addAtBeginning(n,this.adapter.visible.first-1,l),this.adapter.visible.first=n,this.adapter.updateOffset(r)}triggerPrefetch(t){this.prefetchTimeout>=0&&clearTimeout(this.prefetchTimeout);const e=this.adapter.visible.last<this.adapter.visible.forcedLast+this.options.prefetchRows,i=this.adapter.visible.first>this.adapter.visible.forcedFirst-this.options.prefetchRows,s=this.adapter.visible.last===this.adapter.context.numberOfRows,o=0===this.adapter.visible.first;if(t&&!e&&!s||!t&&!i&&!o)return;const n=t||o?this.prefetchDown.bind(this):this.prefetchUp.bind(this);this.prefetchTimeout=setTimeout(n,this.options.delay)}cleanUpTop(t){this.prefetchTimeout=-1;const e=Math.max(0,t-this.options.cleanUpRows);if(e<=this.adapter.visible.first)return;const i=this.adapter.syncFrozen?this.adapter.syncFrozen(e):0;this.adapter.removeFromBeginning(this.adapter.visible.first,e-1,i);const s=this.adapter.context;let o=(e-this.adapter.visible.first)*s.defaultRowHeight;if(s.exceptions.length>0)for(let t=this.adapter.visible.first;t<e;++t)s.exceptionsLookup.has(t)&&(o+=s.exceptionsLookup.get(t)-s.defaultRowHeight);this.adapter.visible.first=e,this.adapter.updateOffset(this.adapter.visibleFirstRowPos+o),this.prefetchDown()}cleanUpBottom(t){this.prefetchTimeout=-1;const e=t+this.options.cleanUpRows;this.adapter.visible.last<=e||(this.adapter.removeFromBottom(e+1,this.adapter.visible.last),this.adapter.visible.last=e,this.prefetchUp())}triggerCleanUp(t,e,i){this.prefetchTimeout>=0&&clearTimeout(this.prefetchTimeout),i&&t-this.options.cleanUpRows<=this.adapter.visible.first||!i&&this.adapter.visible.last<=e+this.options.cleanUpRows||(this.prefetchTimeout=setTimeout(i?this.cleanUpTop.bind(this):this.cleanUpBottom.bind(this),this.options.delay,i?t:e))}onScrolled(t,e){e===o.a.NONE?this.options.cleanUpRows>0&&this.triggerCleanUp(this.adapter.visible.forcedFirst,this.adapter.visible.forcedLast,t):this.options.prefetchRows>0&&this.triggerPrefetch(t)}}},function(t,e,i){"use strict";var s=i(15);i.d(e,"a",function(){return s.a});i(16)},function(t,e,i){"use strict";var s=i(2),o=i(1),n=i(9);e.a=class extends s.b{constructor(t,e,i,s,o={}){super(e,o),this.header=t,this.tableId=i,this.style=s;const r=this;class l extends n.a{get context(){return r.context}createHeader(t,e){return r.createHeader(t,e)}updateHeader(t,e){return r.updateHeader(t,e)}createCell(t,e,i){return r.createCell(t,e,i)}updateCell(t,e,i){return r.updateCell(t,e,i)}forEachRow(t){return r.forEachRow(t)}}this.cell=new l(this.header,this.style,i,...o.mixins||[])}addColumnMixin(t,e){this.cell.addColumnMixin(t,e)}get width(){return this.context.column.totalHeight}get hidden(){return this.header.classList.contains("loading")}set hidden(t){const e=this.hidden;e!==t&&(this.header.classList.toggle("loading",t),this.body.classList.toggle("loading",t),this.onVisibilityChanged(!t))}onVisibilityChanged(t){}hide(){this.hidden=!0}show(t,e,i){this.hidden=!1,this.cell.onScrolledHorizontally(t,e,i)}init(){this.hide(),this.cell.init(),super.init()}destroy(){super.destroy(),this.header.remove(),this.style.remove(this.tableId)}onScrolledVertically(t,e,i){return this.hidden?o.a.NONE:super.onScrolledVertically(t,e,i)}onScrolledHorizontally(t,e,i){return this.cell.onScrolledHorizontally(t,e,i)}updateHeaders(){this.cell.updateHeaders()}updateColumnWidths(){const t=this.context;this.style.update(t.defaultRowHeight-t.padding(-1),t.columns,t.column.padding,this.tableId)}recreate(t){const e=this.bodyScroller,i=e.scrollLeft;this.cell.recreate(i,e.clientWidth),super.recreate(t),e.scrollLeft=i}clearPool(){super.clearPool(),this.cell.clearPool()}createRow(t,e){this.cell.createRow(t,e)}updateRow(t,e){this.cell.updateRow(t,e)}}},function(t,e,i){"use strict";i(0),i(1),i(3)}])});